<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="map-title-tag">Explore Map</title>
    
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet"> 

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/SVRQLilf5/A3z47T2JdI="
        crossorigin=""/>
    
    <style>
        /* ‡§Æ‡•Ö‡§™ ‡§ï‡§Ç‡§ü‡•á‡§®‡§∞‡§∏‡§æ‡§†‡•Ä ‡§∏‡•ç‡§ü‡§æ‡§à‡§≤: ‡§Ø‡§æ‡§ö‡•Ä ‡§â‡§Ç‡§ö‡•Ä ‡§Ö‡§∏‡§£‡•á ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§Ü‡§π‡•á! */
        #mapid { 
            height: 600px; 
            width: 100%;
            border: 5px solid var(--sepia-accent);
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body>
    <div class="container" style="padding-top: 50px; padding-bottom: 50px;">
        
        <button id="back-button" class="btn mb-4" style="background: var(--sepia-medium); color: var(--text-primary);">
            <i class="fas fa-arrow-left me-2"></i>Back to Cities
        </button>

        <h2 id="map-header" style="font-family: 'Playfair Display', serif; margin-bottom: 1.5rem;">Loading Map...</h2>
        
        <div id="mapid"></div>

    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20n6a32GMQcT/Lg2R3iA8B7+zX6n7+w6C/E/B5j+D3E="
        crossorigin=""></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const params = new URLSearchParams(window.location.search);
            const place = decodeURIComponent(params.get('place') || '');
            
            document.getElementById('map-header').textContent = `Interactive Map of Heritage Sites in ${place}`;
            document.getElementById('map-title-tag').textContent = `${place} Map`;

            // Back button functionality
            document.getElementById('back-button').onclick = () => {
                window.location.href = 'index.html';
            };

            // üö® ‡§≠‡•å‡§ó‡•ã‡§≤‡§ø‡§ï ‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø (Coordinates) üö®
            let lat = 19.7515; // Maharashtra Default
            let lon = 75.7139; 
            let zoomLevel = 7;

            if (place === 'Mumbai') {
                lat = 19.0760;
                lon = 72.8777;
                zoomLevel = 11;
            } else if (place === 'Pune') {
                lat = 18.5204;
                lon = 73.8567;
                zoomLevel = 12;
            } else if (place === 'Chhatrapati Sambhaji Nagar') {
                lat = 19.8762;
                lon = 75.3433;
                zoomLevel = 11;
            } 

            // ‡§Æ‡•Ö‡§™ ‡§∏‡•Å‡§∞‡•Ç ‡§ï‡§∞‡§æ (Map initialization)
            // ‡§π‡•á ‡§∏‡•Å‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡§§‡•á ‡§ï‡•Ä #mapid ‡§π‡§æ ‡§ò‡§ü‡§ï (element) ‡§Ö‡§∏‡•ç‡§§‡§ø‡§§‡•ç‡§µ‡§æ‡§§ ‡§Ü‡§π‡•á
            const mapContainer = document.getElementById('mapid');
            if (mapContainer && L) { // L (Leaflet object) ‡§≤‡•ã‡§° ‡§ù‡§æ‡§≤‡§æ ‡§Ü‡§π‡•á ‡§ï‡•Ä ‡§®‡§æ‡§π‡•Ä ‡§§‡•á ‡§§‡§™‡§æ‡§∏‡§æ.
                const mymap = L.map('mapid').setView([lat, lon], zoomLevel);

                // OpenStreetMap layer (‡§®‡§ï‡§æ‡§∂‡§æ‡§ö‡§æ ‡§¨‡•á‡§∏)
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap contributors</a>'
                }).addTo(mymap);

                // ‡§®‡§ø‡§µ‡§°‡§≤‡•á‡§≤‡•ç‡§Ø‡§æ ‡§∂‡§π‡§∞‡§æ‡§µ‡§∞ ‡§Æ‡§æ‡§∞‡•ç‡§ï‡§∞ ‡§ú‡•ã‡§°‡§æ 
                L.marker([lat, lon]).addTo(mymap)
                    .bindPopup(`<b>${place}</b><br>Selected City Center.`)
                    .openPopup();
            } else {
                 mapContainer.innerHTML = "<p style='color: red;'>Error: Map Library (Leaflet) failed to load or map container not found. Check internet connection and F12 Console.</p>";
            }
        });
    </script>
</body>
</html>
